<!DOCTYPE html>
<html lang="en">

<head>
    <title>Dynamic Video Stream - @criccoder</title>
    <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Telegram_logo.svg/2048px-Telegram_logo.svg.png" type="image/png" sizes="250x250">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.1.1/shaka-player.ui.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.1.1/controls.min.css" crossorigin="anonymous" />
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: black;
            color: white;
        }

        .video-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
</head>

<body>
    <div class="video-container">
        <video autoplay muted id="video" poster="https://www.disneystar.com/media/2231/7e25132017-009.jpg?width=1920&height=1080&mode=max&slimmage=true" aria-label="Live video stream"></video>
    </div>

    <script>
        // Define stream configurations including URLs and DRM keys
        const videoConfigs = {
            "USANETWORK": {
                url: "https://fsly.stream.peacocktv.com/Content/CMAF_OL1-CTR-4s/Live/channel(usa-west)/master.mpd",
                k1: "252a671825ba31ec8433f978c32ccf6d",
                k2: "ee560759ecc8d2274df2e63fcef56915"
            },
            "UNIVERSO": {
                url: "https://fsly.stream.peacocktv.com/Content/CMAF_OL1-CTR-4s/Live/channel(universo-east)/master.mpd",
                k1: "232d71bb013d39ffb92ee8c576fb7e8e",
                k2: "087408a48be8d57046c3868b37ea90ba"
            },
            "AMAZON_CRICKET_ENG": {
                url: "https://aba5sdmaaaaaaaamd2pqhgokntneg.otte.live.cf.ww.aiv-cdn.net/pdx-nitro/live/clients/dash/enc/mfvez6cbji/out/v1/108bfdad52584b3dac8da45d0b679e7d/cenc.mpd",
                k1: "29d389f476fe821be2fa93f48377cf66",
                k2: "a9edff53a726d123acfed56e68d0299e"
            },
            "AMAZON_CRICKET_HINDI": {
                url: "https://a120aivottepl-a.akamaihd.net/pdx-nitro/live/clients/dash/enc/cikydktuif/out/v1/c0373ca1f8a441c29bb4dbb193c4a39c/cenc.mpd",
                k1: "913680cbb31c57ae4004ec030b5ec223",
                k2: "5ea27cc20c4fa3474e67c1a8083e45c9"
            },
            "FANCODE": {
                url: "https://a39aivottlinear-a.akamaihd.net/OTTB/sin-nitro/live/clients/dash/enc/l8j2xgwt32/out/v1/fe72171ab2684ab8b9ee3e2ffcc9cff2/cenc.mpd",
                k1: "159a2b4e1d2d7f16892d35d935a2fb34",
                k2: "07809840dd0f511221ca78459167d1b3"
            }
        };

        // Function to get the value of a query parameter by name
        function getQueryParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Function to load the stream based on the stream ID or query parameter
        async function loadStream() {
            const streamId = getQueryParameter("id");
            
            if (!streamId || !videoConfigs[streamId]) {
                console.error("Stream ID is missing or invalid");
                return;
            }

            const videoElement = document.getElementById("video");
            const player = new shaka.Player(videoElement);

            // Configure DRM for the stream using provided keys
            player.configure({
                drm: {
                    clearKeys: {
                        [videoConfigs[streamId].k1]: videoConfigs[streamId].k2
                    }
                }
            });

            // Load the selected stream
            try {
                await player.load(videoConfigs[streamId].url);
                console.log(`Stream ${streamId} has been loaded!`);
            } catch (error) {
                console.error("Error loading the stream:", error);
            }

            // Update the URL with the selected stream ID (optional)
            window.history.pushState({}, "", `?id=${streamId}`);
        }

        // Automatically load the stream based on the URL parameter
        window.onload = function () {
            loadStream(); // Load stream when page loads
        };
    </script>
</body>

</html>
