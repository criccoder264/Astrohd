<!DOCTYPE html>
<html>

<head>
    <title>CricMax Life - @criccoder</title>
    <link rel=icon href="https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/Telegram_logo.svg/2048px-Telegram_logo.svg.png" type="image/png" sizes="250x250">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.1/shaka-player.ui.min.js" crossorigin="anonymous"></script>    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.1/controls.min.css" crossorigin="anonymous">
    <style>
        /* Overflow menu style */
        .shaka-overflow-menu {
            background-color: rgb(41, 41, 163);
            color: rgb(153, 153, 153);
        }

        .shaka-overflow-menu button:hover {
            background-color: rgb(45, 45, 45);
        }

        .shaka-spinner-container { 
            display: none; 
        }

        .shaka-overflow-button-label {
            color: rgb(245, 245, 245);
        }

        .shaka-current-selection-span {
            color: rgb(202, 202, 202);
        }

        .material-icons-round {
            color: rgb(230, 230, 230);
        }

        /* Overflow sub menu style */
        .shaka-settings-menu {
            background-color: rgb(35, 35, 35);
            color: rgb(255, 255, 255);
        }

        .shaka-settings-menu button {
            color: rgb(255, 255, 255);
        }

        .shaka-settings-menu button:hover {
            background-color: rgb(45, 45, 45);
        }

        /* Style for the message form */
        #messageForm {
            display: none;
            background-color: rgba(0, 0, 0, 0.7);
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            border-radius: 8px;
            color: white;
            width: 300px;
            text-align: center;
        }

        #messageForm textarea {
            width: 100%;
            height: 100px;
            margin-bottom: 10px;
            background-color: #333;
            color: white;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 10px;
        }

        #messageForm button {
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #messageForm button:hover {
            background-color: #218838;
        }
    </style>
</head>

<body bgcolor="black" style="margin:0" oncopy="handleCopy(event)">
    <center>
        <div data-shaka-player-container style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover">
            <video autoplay muted data-shaka-player id="video" poster="https://i.postimg.cc/nMfj9gjq/evision-and-Cricbuzz-collaboration.png" width="1920" height="1080" mode="max" slimmage="true" style="width:100%;height:100%"></video>
        </div>
    </center>

    <!-- Message Form (Initially hidden) -->
    <div id="messageForm">
        <h3>Leave a message for the admin</h3>
        <textarea id="userMessage" placeholder="Enter your message here..."></textarea>
        <button onclick="submitMessage()">Send Message</button>
    </div>

    <script>
        const manifestUri = "https://uselector.cdn.intigral-ott.net/CRL2/CRL2.isml/manifest.mpd";

        async function init() {
            const video = document.getElementById('video');
            const ui = video.ui; // assuming 'ui' is already an object attached to the 'video'
            const controls = ui.getControls();
            const player = controls.getPlayer();

            window.player = player;
            window.ui = ui;

            player.configure({
                drm: {
                    "clearKeys": {
                        "77889c7295e1f113852aa6030242b8e4": "ec8c522d46888a15ff6533aa28ccd7f5"
                    }
                }
            });

            player.addEventListener('error', onPlayerErrorEvent);
            controls.addEventListener('error', onUIErrorEvent);

            try {
                await player.load(manifestUri);
                console.log('The video has now been loaded!');
            } catch (error) {
                onPlayerError(error);
            }
        }

        function onPlayerErrorEvent(errorEvent) {
            onPlayerError(errorEvent.detail); // correct reference to event.detail
        }

        function onPlayerError(error) {
            console.error('Error code', error.code, 'object', error);
        }

        function onUIErrorEvent(errorEvent) {
            onPlayerError(errorEvent.detail); // correct reference to event.detail
        }

        function initFailed(errorEvent) {
            console.error('Unable to load the UI library!');
        }

        document.addEventListener('shaka-ui-loaded', init);
        document.addEventListener('shaka-ui-load-failed', initFailed);

        // Handle copy event to block copying and show message form
        function handleCopy(event) {
            event.preventDefault(); // Prevent copying
            document.getElementById('messageForm').style.display = 'block'; // Show the message form
        }

        // Function to handle message submission
        function submitMessage() {
            const message = document.getElementById('userMessage').value;
            if (message.trim() !== "") {
                // Here you would send the message to the server or admin (via AJAX or form submission).
                alert('Message sent to the admin: ' + message);
                
                // Clear the form and hide it after submission
                document.getElementById('userMessage').value = '';
                document.getElementById('messageForm').style.display = 'none';
            } else {
                alert('Please enter a message!');
            }
        }
    </script>
</body>

</html>
